<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Structuring a complex schema &#8212; Understanding JSON Schema 2020-12 documentation</title>
    <link rel="stylesheet" href="_static/jsonschema.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script type="text/javascript" src="_static/jsonschema.js"></script>
    <link rel="shortcut icon" href="_static/logo.ico"/>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Acknowledgments" href="credits.html" />
    <link rel="prev" title="Declaring a Dialect" href="reference/schema.html" />

<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="_static/js/jquery-1.12.4.min.js "></script>
<script type="text/javascript" src="_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="_static/bootstrap-3.4.1/js/bootstrap.min.js "></script>
<script type="text/javascript" src="_static/bootstrap-sphinx.js "></script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-99695987-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-99695987-1');
</script>

  </head><body>
  
  <a href="https://github.com/json-schema-org/understanding-json-schema"
     class="visible-desktop"><img
    style="position: absolute; z-index: 10; top: 40px; right: 0; border: 0;"
    src="https://s3.amazonaws.com/github/ribbons/forkme_right_white_ffffff.png"
    alt="Fork me on GitHub"></a>


  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Understanding JSON Schema</a>
        <span class="navbar-text navbar-version pull-left"><b>2020-12</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Document <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Conventions used in this book</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">What is a schema?</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">The basics</a></li>
<li class="toctree-l1"><a class="reference internal" href="reference/index.html">JSON Schema Reference</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Structuring a complex schema</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="credits.html">Acknowledgments</a></li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="reference/schema.html" title="Previous Chapter: Declaring a Dialect"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Declaring a Dialect</span>
    </a>
  </li>
  <li>
    <a href="credits.html" title="Next Chapter: Acknowledgments"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Acknowledgments &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="section" id="structuring-a-complex-schema">
<span id="structuring"></span><span id="index-0"></span><h1>Structuring a complex schema<a class="headerlink" href="#structuring-a-complex-schema" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#schema-identification" id="id12">Schema Identification</a></li>
<li><a class="reference internal" href="#base-uri" id="id13">Base URI</a><ul>
<li><a class="reference internal" href="#retrieval-uri" id="id14">Retrieval URI</a></li>
<li><a class="reference internal" href="#id" id="id15">$id</a></li>
<li><a class="reference internal" href="#json-pointer" id="id16">JSON Pointer</a></li>
<li><a class="reference internal" href="#anchor" id="id17">$anchor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ref" id="id18">$ref</a></li>
<li><a class="reference internal" href="#defs" id="id19">$defs</a></li>
<li><a class="reference internal" href="#recursion" id="id20">Recursion</a></li>
<li><a class="reference internal" href="#extending-recursive-schemas" id="id21">Extending Recursive Schemas</a></li>
<li><a class="reference internal" href="#bundling" id="id22">Bundling</a></li>
</ul>
</div>
<p>When writing computer programs of even moderate complexity, it’s
commonly accepted that “structuring” the program into reusable
functions is better than copying-and-pasting duplicate bits of code
everywhere they are used.  Likewise in JSON Schema, for anything but
the most trivial schema, it’s really useful to structure the schema
into parts that can be reused in a number of places.  This chapter
will present the tools available for reusing and structuring schemas
as well as some practical examples that use those tools.</p>
<div class="section" id="schema-identification">
<span id="index-1"></span><span id="id1"></span><h2><a class="toc-backref" href="#id12">Schema Identification</a><a class="headerlink" href="#schema-identification" title="Permalink to this headline">¶</a></h2>
<p>Like any other code, schemas are easier to maintain if they can be
broken down into logical units that reference each other as necessary.
In order to reference a schema, we need a way to identify a schema.
Schema documents are identified by non-relative URIs.</p>
<p>Schema documents are not required to have an identifier, but
you will need one if you want to reference one schema from
another. In this documentation, we will refer to schemas with no
identifier as “anonymous schemas”.</p>
<p>In the following sections we will see how the “identifier” for a
schema is determined.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>URI terminology can sometimes be unintuitive. In this document, the
following definitions are used.</p>
<ul class="last simple">
<li><strong>URI</strong> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc3986#section-3">[1]</a> or
<strong>non-relative URI</strong>: A full URI containing a scheme (<code class="docutils literal notranslate"><span class="pre">https</span></code>).
It may contain a URI fragment (<code class="docutils literal notranslate"><span class="pre">#foo</span></code>). Sometimes this document
will use “non-relative URI” to make it extra clear that relative
URIs are not allowed.</li>
<li><strong>relative reference</strong> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc3986#section-4.2">[2]</a>: A
partial URI that does not contain a scheme (<code class="docutils literal notranslate"><span class="pre">https</span></code>). It may
contain a fragment (<code class="docutils literal notranslate"><span class="pre">#foo</span></code>).</li>
<li><strong>URI-reference</strong> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc3986#section-4.1">[3]</a>: A
relative reference or non-relative URI. It may contain a URI
fragment (<code class="docutils literal notranslate"><span class="pre">#foo</span></code>).</li>
<li><strong>absolute URI</strong> <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc3986#section-4.3">[4]</a> A
full URI containing a scheme (<code class="docutils literal notranslate"><span class="pre">https</span></code>) but not a URI fragment
(<code class="docutils literal notranslate"><span class="pre">#foo</span></code>).</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Even though schemas are identified by URIs, those identifiers are
not necessarily network-addressable. They are just identifiers.
Generally, implementations don’t make HTTP requests (<code class="docutils literal notranslate"><span class="pre">https://</span></code>)
or read from the file system (<code class="docutils literal notranslate"><span class="pre">file://</span></code>) to fetch schemas.
Instead, they provide a way to load schemas into an internal schema
database. When a schema is referenced by it’s URI identifier, the
schema is retrieved from the internal schema database.</p>
</div>
</div>
<div class="section" id="base-uri">
<span id="index-2"></span><span id="id2"></span><h2><a class="toc-backref" href="#id13">Base URI</a><a class="headerlink" href="#base-uri" title="Permalink to this headline">¶</a></h2>
<p>Using non-relative URIs can be cumbersome, so any URIs used in
JSON Schema can be URI-references that resolve against the schema’s
base URI resulting in a non-relative URI. This section describes how a
schema’s base URI is determined.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Base URI determination and relative reference resolution is defined
by <a class="reference external" href="https://datatracker.ietf.org/doc/html/rfc3986#section-5">RFC-3986</a>. If
you are familiar with how this works in HTML, this section should
feel very familiar.</p>
</div>
<div class="section" id="retrieval-uri">
<span id="index-3"></span><span id="id3"></span><h3><a class="toc-backref" href="#id14">Retrieval URI</a><a class="headerlink" href="#retrieval-uri" title="Permalink to this headline">¶</a></h3>
<p>The URI used to fetch a schema is known as the “retrieval URI”. It’s
often possible to pass an anonymous schema to an implementation in
which case that schema would have no retrieval URI.</p>
<p>Let’s assume a schema is referenced using the URI
<code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address</span></code> and the following schema is
retrieved.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;street_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The base URI for this schema is the same as the retrieval URI,
<code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address</span></code>.</p>
</div>
<div class="section" id="id">
<span id="index-4"></span><span id="id4"></span><h3><a class="toc-backref" href="#id15">$id</a><a class="headerlink" href="#id" title="Permalink to this headline">¶</a></h3>
<p>You can set the base URI by using the <code class="docutils literal notranslate"><span class="pre">$id</span></code> keyword at the root of
the schema. The value of <code class="docutils literal notranslate"><span class="pre">$id</span></code> is a URI-reference without a fragment
that resolves against the <a class="reference internal" href="#retrieval-uri"><span class="std std-ref">Retrieval URI</span></a>. The resulting URI is the
base URI for the schema.</p>
<div class="tabbable">
<ul class="nav nav-tabs simple">
<li class="disabled"><a class="disabled">Draft-specific info:</a></li>
<li class="active"><a data-toggle="tab" href="#7fb85ccb2ce0_Draft_4">Draft 4</a></li>
<li><a data-toggle="tab" href="#7fb85ccb2ce0_Draft_4_7">Draft 4-7</a></li>
</ul>
<div class="tab-content section">
<div class="tab-pane active section" id="7fb85ccb2ce0_Draft_4">
In Draft 4, <code class="docutils literal notranslate"><span class="pre">$id</span></code> is just <code class="docutils literal notranslate"><span class="pre">id</span></code> (without the dollar sign).</div>
<div class="tab-pane section" id="7fb85ccb2ce0_Draft_4_7">
In Draft 4-7 it was allowed to have fragments in an <code class="docutils literal notranslate"><span class="pre">$id</span></code> (or
<code class="docutils literal notranslate"><span class="pre">id</span></code> in Draft 4). However, the behavior when setting a base URI
that contains a URI fragment is undefined and should not be used
because implementations may treat them differently.</div>
</div>
</div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is analogous to the <code class="docutils literal notranslate"><span class="pre">&lt;base&gt;</span></code> <a class="reference external" href="https://html.spec.whatwg.org/multipage/semantics.html#the-base-element">tag in HTML</a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">When the <code class="docutils literal notranslate"><span class="pre">$id</span></code> keyword appears in a subschema, it means something
slightly different. See the <a class="reference internal" href="#bundling"><span class="std std-ref">Bundling</span></a> section for more.</p>
</div>
<p>Let’s assume the URIs <code class="docutils literal notranslate"><span class="pre">https://example.com/schema/address</span></code> and
<code class="docutils literal notranslate"><span class="pre">https://example.com/schema/billing-address</span></code> both identify the
following schema.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;street_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>No matter which of the two URIs is used to retrieve this schema, the
base URI will be <code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address</span></code>, which is the
result of the <code class="docutils literal notranslate"><span class="pre">$id</span></code> URI-reference resolving against the
<a class="reference internal" href="#retrieval-uri"><span class="std std-ref">Retrieval URI</span></a>.</p>
<p>However, using a relative reference when setting a base URI can be
problematic. For example, we couldn’t use this schema as an
anonymous schema because there would be no <a class="reference internal" href="#retrieval-uri"><span class="std std-ref">Retrieval URI</span></a> and you
can’t resolve a relative reference against nothing. For this and other
reasons, it’s recommended that you always use an absolute URI when
declaring a base URI with <code class="docutils literal notranslate"><span class="pre">$id</span></code>.</p>
<p>The base URI of the following schema will always be
<code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address</span></code> no matter what the
<a class="reference internal" href="#retrieval-uri"><span class="std std-ref">Retrieval URI</span></a> was or if it’s used as an anonymous schema.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/address&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;street_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="json-pointer">
<span id="index-5"></span><span id="id5"></span><h3><a class="toc-backref" href="#id16">JSON Pointer</a><a class="headerlink" href="#json-pointer" title="Permalink to this headline">¶</a></h3>
<p>In addition to identifying a schema document, you can also identify
subschemas. The most common way to do that is to use a <a class="reference external" href="https://tools.ietf.org/html/rfc6901">JSON Pointer</a> in the URI fragment that
points to the subschema.</p>
<p>A JSON Pointer describes a slash-separated path to traverse the keys
in the objects in the document. Therefore,
<code class="docutils literal notranslate"><span class="pre">/properties/street_address</span></code> means:</p>
<ol class="arabic simple">
<li>find the value of the key <code class="docutils literal notranslate"><span class="pre">properties</span></code></li>
<li>within that object, find the value of the key <code class="docutils literal notranslate"><span class="pre">street_address</span></code></li>
</ol>
<p>The URI
<code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address#/properties/street_address</span></code>
identifies the highlighted subschema in the following schema.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/address&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;street_address&quot;</span><span class="o">:</span>
<span class="hll">      <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
</span>    <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="anchor">
<span id="index-6"></span><span id="id6"></span><h3><a class="toc-backref" href="#id17">$anchor</a><a class="headerlink" href="#anchor" title="Permalink to this headline">¶</a></h3>
<p>A less common way to identify a subschema is to create a named anchor
in the schema using the <code class="docutils literal notranslate"><span class="pre">$anchor</span></code> keyword and using that name in the
URI fragment. Anchors must start with a letter followed by any number
of letters, digits, <code class="docutils literal notranslate"><span class="pre">-</span></code>, <code class="docutils literal notranslate"><span class="pre">_</span></code>, <code class="docutils literal notranslate"><span class="pre">:</span></code>, or <code class="docutils literal notranslate"><span class="pre">.</span></code>.</p>
<div class="tabbable">
<ul class="nav nav-tabs simple">
<li class="disabled"><a class="disabled">Draft-specific info:</a></li>
<li class="active"><a data-toggle="tab" href="#7fb85ccd9750_Draft_4">Draft 4</a></li>
<li><a data-toggle="tab" href="#7fb85ccd9750_Draft_6_7">Draft 6-7</a></li>
</ul>
<div class="tab-content section">
<div class="tab-pane active section" id="7fb85ccd9750_Draft_4">
In Draft 4, you declare an anchor the same way you do in Draft 6-7
except that <code class="docutils literal notranslate"><span class="pre">$id</span></code> is just <code class="docutils literal notranslate"><span class="pre">id</span></code> (without the dollar sign).</div>
<div class="tab-pane section" id="7fb85ccd9750_Draft_6_7">
<p>In Draft 6-7, a named anchor is defined using an <code class="docutils literal notranslate"><span class="pre">$id</span></code> that
contains only a URI fragment. The value of the URI fragment is the
name of the anchor.</p>
<p>JSON Schema doesn't define how <code class="docutils literal notranslate"><span class="pre">$id</span></code> should be interpreted when
it contains both fragment and non-fragment URI parts. Therefore,
when setting a named anchor, you should not use non-fragment URI
parts in the URI-reference.</p>
</div>
</div>
</div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If a named anchor is defined that doesn’t follow these naming
rules, then behavior is undefined. Your anchors might work in some
implementation, but not others.</p>
</div>
<p>The URI <code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address#street_address</span></code>
identifies the subschema on the highlighted part of the following
schema.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/address&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;street_address&quot;</span><span class="o">:</span>
<span class="hll">      <span class="p">{</span>
</span><span class="hll">        <span class="s2">&quot;$anchor&quot;</span><span class="o">:</span> <span class="s2">&quot;street_address&quot;</span><span class="p">,</span>
</span><span class="hll">        <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span>
</span><span class="hll">      <span class="p">},</span>
</span>    <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ref">
<span id="index-7"></span><span id="id7"></span><h2><a class="toc-backref" href="#id18">$ref</a><a class="headerlink" href="#ref" title="Permalink to this headline">¶</a></h2>
<p>A schema can reference another schema using the <code class="docutils literal notranslate"><span class="pre">$ref</span></code> keyword. The
value of <code class="docutils literal notranslate"><span class="pre">$ref</span></code> is a URI-reference that is resolved against the
schema’s <a class="reference internal" href="#base-uri"><span class="std std-ref">Base URI</span></a>. When evaluating a <code class="docutils literal notranslate"><span class="pre">$ref</span></code>, an implementation
uses the resolved identifier to retrieve the referenced schema and
applies that schema to the instance.</p>
<div class="tabbable">
<ul class="nav nav-tabs simple">
<li class="disabled"><a class="disabled">Draft-specific info:</a></li>
<li class="active"><a data-toggle="tab" href="#7fb85ccda0b0_Draft_4_7">Draft 4-7</a></li>
</ul>
<div class="tab-content section">
<div class="tab-pane active section" id="7fb85ccda0b0_Draft_4_7">
In Draft 4-7, <code class="docutils literal notranslate"><span class="pre">$ref</span></code> behaves a little differently. When an
object contains a <code class="docutils literal notranslate"><span class="pre">$ref</span></code> property, the object is considered a
reference, not a schema. Therefore, any other properties you put
in that object will not be treated as JSON Schema keywords and will
be ignored by the validator. <code class="docutils literal notranslate"><span class="pre">$ref</span></code> can only be used where a
schema is expected.</div>
</div>
</div><p>For this example, let’s say we want to define a customer record, where
each customer may have both a shipping and a billing address.
Addresses are always the same—they have a street address, city and
state—so we don’t want to duplicate that part of the schema
everywhere we want to store an address.  Not only would that make the
schema more verbose, but it makes updating it in the future more
difficult.  If our imaginary company were to start doing international
business in the future and we wanted to add a country field to all the
addresses, it would be better to do this in a single place rather than
everywhere that addresses are used.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/customer&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;shipping_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;billing_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;shipping_address&quot;</span><span class="p">,</span> <span class="s2">&quot;billing_address&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The URI-references in <code class="docutils literal notranslate"><span class="pre">$ref</span></code> resolve against the schema’s <a class="reference internal" href="#base-uri"><span class="std std-ref">Base URI</span></a>
(<code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/customer</span></code>) which results in
<code class="docutils literal notranslate"><span class="pre">https://example.com/schemas/address</span></code>. The implementation retrieves
that schema and uses it to evaluate the “shipping_address” and
“billing_address” properties.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When using <code class="docutils literal notranslate"><span class="pre">$ref</span></code> in an anonymous schema, relative references may
not be resolvable. Let’s assume this example is used as an
anonymous schema.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;shipping_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/address&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;billing_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;shipping_address&quot;</span><span class="p">,</span> <span class="s2">&quot;billing_address&quot;</span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="last">The <code class="docutils literal notranslate"><span class="pre">$ref</span></code> at <code class="docutils literal notranslate"><span class="pre">/properties/shipping_address</span></code> can resolve just
fine without a non-relative base URI to resolve against, but the
<code class="docutils literal notranslate"><span class="pre">$ref</span></code> at <code class="docutils literal notranslate"><span class="pre">/properties/billing_address</span></code> can’t resolve to a
non-relative URI and therefore can’t can be used to retrieve the
address schema.</p>
</div>
</div>
<div class="section" id="defs">
<span id="index-8"></span><span id="id8"></span><h2><a class="toc-backref" href="#id19">$defs</a><a class="headerlink" href="#defs" title="Permalink to this headline">¶</a></h2>
<p>Sometimes we have small subschemas that are only intended for use in
the current schema and it doesn’t make sense to define them as
separate schemas. Although we can identify any subschema using JSON
Pointers or named anchors, the <code class="docutils literal notranslate"><span class="pre">$defs</span></code> keyword gives us a
standardized place to keep subschemas intended for reuse in the
current schema document.</p>
<p>Let’s extend the previous customer schema example to use a common
schema for the name properties. It doesn’t make sense to define a new
schema for this and it will only be used in this schema, so it’s a
good candidate for using <code class="docutils literal notranslate"><span class="pre">$defs</span></code>.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/customer&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;#/$defs/name&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;#/$defs/name&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;shipping_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;billing_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;shipping_address&quot;</span><span class="p">,</span> <span class="s2">&quot;billing_address&quot;</span><span class="p">],</span>

  <span class="s2">&quot;$defs&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">$ref</span></code> isn’t just good for avoiding duplication. It can also be
useful for writing schemas that are easier to read and maintain.
Complex parts of the schema can be defined in <code class="docutils literal notranslate"><span class="pre">$defs</span></code> with
descriptive names and referenced where it’s needed. This allows
readers of the schema to more quickly and easily understand the schema
at a high level before diving into the more complex parts.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It’s possible to reference an external subschema, but generally you
want to limit a <code class="docutils literal notranslate"><span class="pre">$ref</span></code> to referencing either an external schema
or an internal subschema defined in <code class="docutils literal notranslate"><span class="pre">$defs</span></code>.</p>
</div>
</div>
<div class="section" id="recursion">
<span id="index-9"></span><span id="id9"></span><h2><a class="toc-backref" href="#id20">Recursion</a><a class="headerlink" href="#recursion" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">$ref</span></code> keyword may be used to create recursive schemas that
refer to themselves. For example, you might have a <code class="docutils literal notranslate"><span class="pre">person</span></code> schema
that has an array of <code class="docutils literal notranslate"><span class="pre">children</span></code>, each of which are also <code class="docutils literal notranslate"><span class="pre">person</span></code>
instances.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;children&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;array&quot;</span><span class="p">,</span>
<span class="hll">      <span class="s2">&quot;items&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;#&quot;</span> <span class="p">}</span>
</span>    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p class="jsonschema-comment">A snippet of the British royal family tree</p>
<div class="jsonschema-pass highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Elizabeth&quot;</span><span class="p">,</span>
  <span class="s2">&quot;children&quot;</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Charles&quot;</span><span class="p">,</span>
      <span class="s2">&quot;children&quot;</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;William&quot;</span><span class="p">,</span>
          <span class="s2">&quot;children&quot;</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;George&quot;</span> <span class="p">},</span>
            <span class="p">{</span> <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Charlotte&quot;</span> <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="s2">&quot;name&quot;</span><span class="o">:</span> <span class="s2">&quot;Harry&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Above, we created a schema that refers to itself, effectively creating
a “loop” in the validator, which is both allowed and useful. Note,
however, that a <code class="docutils literal notranslate"><span class="pre">$ref</span></code> referring to another <code class="docutils literal notranslate"><span class="pre">$ref</span></code> could cause
an infinite loop in the resolver, and is explicitly disallowed.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$defs&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;alice&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;#/$defs/bob&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;bob&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;#/$defs/alice&quot;</span> <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="extending-recursive-schemas">
<span id="index-10"></span><span id="id10"></span><h2><a class="toc-backref" href="#id21">Extending Recursive Schemas</a><a class="headerlink" href="#extending-recursive-schemas" title="Permalink to this headline">¶</a></h2>
<p><span class="new">New in draft 2019-09</span></p>
<p>Documentation Coming Soon</p>
</div>
<div class="section" id="bundling">
<span id="index-11"></span><span id="id11"></span><h2><a class="toc-backref" href="#id22">Bundling</a><a class="headerlink" href="#bundling" title="Permalink to this headline">¶</a></h2>
<p>Working with multiple schema documents is convenient for development,
but it’s often more convenient for distribution to bundle all of your
schemas into a single schema document. This can be done using the
<code class="docutils literal notranslate"><span class="pre">$id</span></code> keyword in a subschema. When <code class="docutils literal notranslate"><span class="pre">$id</span></code> is used in a subschema,
it indicates an embedded schema. The identifier for the embedded
schema is the value of <code class="docutils literal notranslate"><span class="pre">$id</span></code> resolved against the <a class="reference internal" href="#base-uri"><span class="std std-ref">Base URI</span></a> of the
schema it appears in. A schema document that includes embedded schemas
is called a Compound Schema Document. Each schema with an <code class="docutils literal notranslate"><span class="pre">$id</span></code> in a
Compound Schema Document is called a Schema Resource.</p>
<div class="tabbable">
<ul class="nav nav-tabs simple">
<li class="disabled"><a class="disabled">Draft-specific info:</a></li>
<li class="active"><a data-toggle="tab" href="#7fb85cb62fe0_Draft_4">Draft 4</a></li>
<li><a data-toggle="tab" href="#7fb85cb62fe0_Draft_4_7">Draft 4-7</a></li>
</ul>
<div class="tab-content section">
<div class="tab-pane active section" id="7fb85cb62fe0_Draft_4">
In Draft 4, <code class="docutils literal notranslate"><span class="pre">$id</span></code> is just <code class="docutils literal notranslate"><span class="pre">id</span></code> (without the dollar sign).</div>
<div class="tab-pane section" id="7fb85cb62fe0_Draft_4_7">
In Draft 4-7, an <code class="docutils literal notranslate"><span class="pre">$id</span></code> in a subschema did not indicate an
embedded schema. Instead it was simply a base URI change in a
single schema document.</div>
</div>
</div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This is analogous to the <code class="docutils literal notranslate"><span class="pre">&lt;iframe&gt;</span></code> <a class="reference external" href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element">tag in HTML</a>.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is unusual to use embedded schemas when developing schemas. It’s
generally best not to use this feature explicitly and use schema
bundling tools to construct bundled schemas if such a thing is
needed.</p>
</div>
<p>This example shows the customer schema example and the address schema
example bundled into a Compound Schema Document.</p>
<div class="jsonschema highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;https://example.com/schemas/customer&quot;</span><span class="p">,</span>
  <span class="s2">&quot;$schema&quot;</span><span class="o">:</span> <span class="s2">&quot;https://json-schema.org/draft/2020-12/schema&quot;</span><span class="p">,</span>

  <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
  <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;shipping_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;billing_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span> <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;first_name&quot;</span><span class="p">,</span> <span class="s2">&quot;last_name&quot;</span><span class="p">,</span> <span class="s2">&quot;shipping_address&quot;</span><span class="p">,</span> <span class="s2">&quot;billing_address&quot;</span><span class="p">],</span>

  <span class="s2">&quot;$defs&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;address&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;$id&quot;</span><span class="o">:</span> <span class="s2">&quot;/schemas/address&quot;</span><span class="p">,</span>
      <span class="s2">&quot;$schema&quot;</span><span class="o">:</span> <span class="s2">&quot;http://json-schema.org/draft-07/schema#&quot;</span><span class="p">,</span>

      <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;object&quot;</span><span class="p">,</span>
      <span class="s2">&quot;properties&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;street_address&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
        <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;type&quot;</span><span class="o">:</span> <span class="s2">&quot;string&quot;</span> <span class="p">},</span>
        <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;$ref&quot;</span><span class="o">:</span> <span class="s2">&quot;#/definitions/state&quot;</span> <span class="p">}</span>
      <span class="p">},</span>
      <span class="s2">&quot;required&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;street_address&quot;</span><span class="p">,</span> <span class="s2">&quot;city&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">],</span>

      <span class="s2">&quot;definitions&quot;</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&quot;enum&quot;</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;CA&quot;</span><span class="p">,</span> <span class="s2">&quot;NY&quot;</span><span class="p">,</span> <span class="s2">&quot;... etc ...&quot;</span><span class="p">]</span> <span class="p">}</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>All references in a Compound Schema Document need to be the same
whether the Schema Resources are bundled or not. Notice that the
<code class="docutils literal notranslate"><span class="pre">$ref</span></code> keywords from the customer schema have not changed. The only
difference is that the address schema is now defined at
<code class="docutils literal notranslate"><span class="pre">/$defs/address</span></code> instead of a separate schema document. You couldn’t
use <code class="docutils literal notranslate"><span class="pre">#/$defs/address</span></code> to reference the address schema because if you
unbundled the schema, that reference would no longer point to the
address schema.</p>
<div class="tabbable">
<ul class="nav nav-tabs simple">
<li class="disabled"><a class="disabled">Draft-specific info:</a></li>
<li class="active"><a data-toggle="tab" href="#7fb85cb603d0_Draft_4_7">Draft 4-7</a></li>
</ul>
<div class="tab-content section">
<div class="tab-pane active section" id="7fb85cb603d0_Draft_4_7">
In Draft 4-7, both of these URIs are valid because a subschema
<code class="docutils literal notranslate"><span class="pre">$id</span></code> only represented a base URI change, not an embedded schema.
However, even though it's allowed, it's still highly recommended
that JSON Pointers don't cross a schema with a base URI change.</div>
</div>
</div><p>You should also see that <code class="docutils literal notranslate"><span class="pre">&quot;$ref&quot;:</span> <span class="pre">&quot;#/definitions/state&quot;</span></code> resolves to
the <code class="docutils literal notranslate"><span class="pre">definitions</span></code> keyword in the address schema rather than the one
at the top level schema like it would if the embedded schema wasn’t
used.</p>
<p>Each Schema Resource is evaluated independently and may use different
JSON Schema dialects. The example above has the address Schema
Resource using Draft 7 while the customer Schema Resource uses Draft
2020-12. If no <code class="docutils literal notranslate"><span class="pre">$schema</span></code> is declared in an embedded schema, it
defaults to using the dialect of the parent schema.</p>
<div class="tabbable">
<ul class="nav nav-tabs simple">
<li class="disabled"><a class="disabled">Draft-specific info:</a></li>
<li class="active"><a data-toggle="tab" href="#7fb85cb61390_Draft_4_7">Draft 4-7</a></li>
</ul>
<div class="tab-content section">
<div class="tab-pane active section" id="7fb85cb61390_Draft_4_7">
In Draft 4-7, a subschema <code class="docutils literal notranslate"><span class="pre">$id</span></code> is just a base URI change and not
considered an independent Schema Resource. Because <code class="docutils literal notranslate"><span class="pre">$schema</span></code> is
only allowed at the root of a Schema Resource, all schemas bundled
using subschema <code class="docutils literal notranslate"><span class="pre">$id</span></code> must use the same dialect.</div>
</div>
</div></div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2013-2016 Michael Droettboom, Space Telescope Science Institute; © 2016-2022 Michael Droettboom.<br/>
      Last updated on Feb 02, 2022.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.6.<br/>
    </p>
  </div>
</footer>
  </body>
</html>